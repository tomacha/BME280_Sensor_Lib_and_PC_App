#include "bme280.hpp"

#include <gtest/gtest.h>

namespace BME280 {
    bme_status sensRead(uint8_t reg_addr, uint8_t *data, uint32_t len)
    {
        return STATUS_OK;
    }

    bme_status sensWrite(uint8_t reg_addr, uint8_t *data, uint32_t len)
    {
        return STATUS_OK;
    }

    void sensDelay(uint32_t ms)
    {
        return;
    }
};

BME280::bme280 sensor(BME280::sensRead, BME280::sensWrite, BME280::sensDelay);

TEST(Tests, bme280_Init_args){   
    EXPECT_EQ(BME280::STATUS_OK, sensor.bme280_Init(BME280::OVERSAMPLING_NONE,BME280::OVERSAMPLING_NONE,BME280::OVERSAMPLING_NONE,
        BME280::MODE_SLEEP,BME280::STANDBY_0_5,BME280::FILTER_OFF));
    EXPECT_EQ(BME280::STATUS_ERROR, sensor.bme280_Init(BME280::OVERSAMPLING_TOP,BME280::OVERSAMPLING_NONE,BME280::OVERSAMPLING_NONE,
        BME280::MODE_SLEEP,BME280::STANDBY_0_5,BME280::FILTER_OFF));
    EXPECT_EQ(BME280::STATUS_ERROR, sensor.bme280_Init(BME280::OVERSAMPLING_NONE,BME280::OVERSAMPLING_TOP,BME280::OVERSAMPLING_NONE,
        BME280::MODE_SLEEP,BME280::STANDBY_0_5,BME280::FILTER_OFF));
    EXPECT_EQ(BME280::STATUS_ERROR, sensor.bme280_Init(BME280::OVERSAMPLING_NONE,BME280::OVERSAMPLING_NONE,BME280::OVERSAMPLING_TOP,
        BME280::MODE_SLEEP,BME280::STANDBY_0_5,BME280::FILTER_OFF));
    EXPECT_EQ(BME280::STATUS_ERROR, sensor.bme280_Init(BME280::OVERSAMPLING_NONE,BME280::OVERSAMPLING_NONE,BME280::OVERSAMPLING_NONE,
        BME280::MODE_TOP,BME280::STANDBY_0_5,BME280::FILTER_OFF));
    EXPECT_EQ(BME280::STATUS_ERROR, sensor.bme280_Init(BME280::OVERSAMPLING_NONE,BME280::OVERSAMPLING_NONE,BME280::OVERSAMPLING_NONE,
        BME280::MODE_SLEEP,BME280::STANDBY_0_5,BME280::FILTER_TOP));
}

TEST(Tests, bme280_Init_write_fail){   
    EXPECT_EQ(BME280::STATUS_ERROR, sensor.bme280_Init(BME280::OVERSAMPLING_NONE,BME280::OVERSAMPLING_NONE,BME280::OVERSAMPLING_NONE,
        BME280::MODE_SLEEP,BME280::STANDBY_0_5,BME280::FILTER_OFF));
}